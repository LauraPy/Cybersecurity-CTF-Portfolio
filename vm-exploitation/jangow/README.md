FINGERPRINTING Jangow Vullhub
Objective: Information gathering about the target machine.

Methods and Tools:
Nmap:
Commands used: nmap -sV -sC -n 192.168.56.118

We found 2 open ports, namely:

Port 21 /tcp vsftpd 3.0.3. This runs on the FTP service.

Port 80 Apache/2.4.18(Ubuntu).

Port 21
What we discovered is that: Vsftpd 3.0.3 is a known vulnerable version. More specifically, it is susceptible to a backdoor vulnerability. Vsftpd version 3.0.3 is known for a backdoor vulnerability (CVE). A denial of service attack can also be performed.

Port 80
Running TCP port 80 on the HTTP service suggests that a potentially vulnerable website is hosted.

Activity: I chose the Jangow VM from VulnHub as the target for this penetration test.

Objective: To evaluate the security of the web application and test the exploitability of LFI vulnerabilities.

Fingerprinting (Initial Information Gathering): I performed an Nmap scan to identify open ports and services running on the target machine. I also checked for available web information.

Objective: To collect information about the target system to identify potential vulnerabilities.

Vulnerability Identification and Evaluation: I inspected the web application and identified an LFI vulnerability.

Objective: To find an exploitable vulnerability to gain system access.

Vulnerability Exploitation: I used a URL manipulation technique to include local files through the LFI vulnerability.

Objective: To gain access to system files via the web application.

Privilege Escalation: I used the exploit.45010.c exploit to modify process credentials and obtain root privileges.

Objective: To gain full control over the target system.

Tools Used:

Nmap: Version 7.91, with options -sV -sC -n

Custom BPF Exploit: Compiled the data compilation

Other tools: gcc ftp.dirb linpeas exploit-db

Results Obtained:

Screenshots: Nmap scan results.

BPF exploit output.

Root shell obtained.

Contents of accessible files.

Log files.

Technical Rationale:
I chose to exploit the BPF vulnerability because it allowed for privilege escalation and offered a high level of control over the system.
I used parameter manipulation for the URL to include local files, applying techniques tailored to the specific application configuration.
I used a verified exploit to ensure it matched the specific kernel version and target system configuration.
Each step of the attack was documented to provide a complete picture of the exploitation process.

Vulnerability Severity Classification:

Vulnerability: Critical. CVSSv3 Score: 7.2 (High).

Observations:
The attack was performed in a controlled test environment, with explicit permission for penetration testing.

Remediation Recommendations
Vulnerability BPF CVE-2017-16995

Kernel Update: It is recommended to update the Linux kernel to the latest stable version, which includes security patches to remediate the BPF vulnerability.

Check Distribution Website: Refer to your Linux distribution's website for specific update instructions.

Disable BPF Functionality: If BPF functionality is not essential for normal system operations, consider disabling it.

Consult Linux Distribution Documentation: Consult your Linux distribution's documentation on how to disable BPF.

Implement SELinux or AppArmor: Utilize kernel security modules, such as SELinux or AppArmor, to limit the impact of potential exploits.

Strict Security Policy Configuration: Configure strict security policies to restrict access to system resources.

Monitor BPF Activity: Implement monitoring systems to detect suspicious activity related to BPF.

Log Analysis: Analyze system logs to identify attempted exploitations.

Avoid FTP Usage: Avoid using FTP; instead, use SFTP.

General Security Recommendations:

Maintain Updated System: Regularly update the system, including all software components, applications, and libraries.

Implement Firewall: Install and configure a firewall to prevent unauthorized network access to the system.

Allow Necessary Traffic: Permit only necessary traffic for normal operations.

Strong Authentication: Implement strong authentication with complex passwords and two-factor authentication to prevent unauthorized access.

System Log Monitoring: Regularly analyze system logs to detect suspicious activities.

Implement Alert System: Implement an alert system to notify administrators about critical events.

Privilege Limitation: Grant minimum necessary privileges for each user and process.

Avoid Root Account Usage: Avoid using the root account for daily activities.

Implement Intrusion Detection System (IDS): Utilize an IDS to detect and alert on attempted intrusions and vulnerabilities.

Perform Penetration Tests: Conduct periodic penetration tests to identify and remediate vulnerabilities.

Update Security Policies: Update security policies based on test results.
